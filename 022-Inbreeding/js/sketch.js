// Generated by CoffeeScript 2.4.1
// http://www.husdyr.kvl.dk/htm/kc/popgen/genetics/4/5.htm
var Calculator, N, facit, i, j, k, l, len, len1, ref, ref1, tree;

Calculator = class Calculator {
  constructor(persons = []) {
    this.persons = persons;
    this.calc();
  }

  add(sire = 0, dame = 0) {
    return this.persons.push({sire, dame});
  }

  calc() {
    var dame, i, j, k, l, len, len1, n, ref, ref1, results, sire;
    n = this.persons.length;
    this.matrix = (function() {
      var k, len, ref, results;
      ref = range(n);
      results = [];
      for (k = 0, len = ref.length; k < len; k++) {
        j = ref[k];
        results.push((function() {
          var l, len1, ref1, results1;
          ref1 = range(n);
          results1 = [];
          for (l = 0, len1 = ref1.length; l < len1; l++) {
            i = ref1[l];
            results1.push(0);
          }
          return results1;
        })());
      }
      return results;
    })();
    ref = range(1, n);
    results = [];
    for (k = 0, len = ref.length; k < len; k++) {
      i = ref[k];
      this.matrix[i][i] = 1;
      ref1 = range(i + 1, n);
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        j = ref1[l];
        [sire, dame] = this.persons[j];
        this.matrix[i][j] = this.matrix[j][i] = (this.matrix[i][sire] + this.matrix[i][dame]) / 2;
      }
      [sire, dame] = this.persons[i];
      results.push(this.matrix[i][i] += this.matrix[sire][dame] / 2);
    }
    return results;
  }

  cell(i, j) {
    return this.matrix[i][j];
  }

};

//###############################
facit = [[0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1 / 2, 1 / 2, 1 / 2, 1 / 2, 1 / 2, 1 / 2], [0, 1 / 2, 1, 1 / 4, 1 / 4, 5 / 8, 1 / 4, 7 / 16], [0, 1 / 2, 1 / 4, 1, 1 / 4, 5 / 8, 5 / 8, 5 / 8], [0, 1 / 2, 1 / 4, 1 / 4, 1, 1 / 4, 5 / 8, 7 / 16], [0, 1 / 2, 5 / 8, 5 / 8, 1 / 4, 1 + 1 / 8, 7 / 16, 25 / 32], [0, 1 / 2, 1 / 4, 5 / 8, 5 / 8, 7 / 16, 1 + 1 / 8, 25 / 32], [0, 1 / 2, 7 / 16, 5 / 8, 7 / 16, 25 / 32, 25 / 32, 1 + 7 / 32]];

tree = new Calculator([[0, 0], [0, 0], [1, 0], [1, 0], [1, 0], [3, 2], [3, 4], [5, 6]]);

N = tree.matrix.length;

ref = range(1, N - 1);
for (k = 0, len = ref.length; k < len; k++) {
  i = ref[k];
  ref1 = range(1, N - 1);
  for (l = 0, len1 = ref1.length; l < len1; l++) {
    j = ref1[l];
    assert(facit[i][j], tree.cell(i, j));
  }
}

assert(1 / 4, tree.cell(3, 2));

assert(1 / 4, tree.cell(3, 4));

assert(7 / 16, tree.cell(5, 6));

//##############################
tree = new Calculator([[0, 0], [0, 0], [0, 0], [1, 2], [1, 2], [3, 4], [3, 4], [5, 6], [5, 6], [7, 8], [7, 8], [9, 10], [9, 10]]);

assert(0, tree.cell(1, 2));

assert(1 / 2, tree.cell(3, 4));

assert(3 / 4, tree.cell(5, 6));

assert(7 / 8, tree.cell(7, 8));

assert(15 / 16, tree.cell(9, 10));

assert(31 / 32, tree.cell(11, 12));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQUEsSUFBQSxVQUFBLEVBQUEsQ0FBQSxFQUFBLEtBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBOztBQUVNLGFBQU4sTUFBQSxXQUFBO0VBQ0MsV0FBYyxXQUFVLEVBQVYsQ0FBQTtJQUFDLElBQUMsQ0FBQTtJQUFlLElBQUMsQ0FBQSxJQUFELENBQUE7RUFBakI7O0VBQ2QsR0FBTSxDQUFDLE9BQUssQ0FBTixFQUFRLE9BQUssQ0FBYixDQUFBO1dBQW1CLElBQUMsQ0FBQSxPQUFPLENBQUMsSUFBVCxDQUFjLENBQUMsSUFBRCxFQUFNLElBQU4sQ0FBZDtFQUFuQjs7RUFDTixJQUFPLENBQUEsQ0FBQTtBQUNOLFFBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLE9BQUEsRUFBQTtJQUFBLENBQUEsR0FBSSxJQUFDLENBQUEsT0FBTyxDQUFDO0lBQ2IsSUFBQyxDQUFBLE1BQUQ7O0FBQThCO0FBQUE7TUFBQSxLQUFBLHFDQUFBOzs7O0FBQWpCO0FBQUE7VUFBQSxLQUFBLHdDQUFBOzswQkFBRjtVQUFFLENBQUE7OztNQUFpQixDQUFBOzs7QUFDOUI7QUFBQTtJQUFBLEtBQUEscUNBQUE7O01BQ0MsSUFBQyxDQUFBLE1BQU8sQ0FBQSxDQUFBLENBQUcsQ0FBQSxDQUFBLENBQVgsR0FBZ0I7QUFDaEI7TUFBQSxLQUFBLHdDQUFBOztRQUNDLENBQUMsSUFBRCxFQUFNLElBQU4sQ0FBQSxHQUFjLElBQUMsQ0FBQSxPQUFRLENBQUEsQ0FBQTtRQUN2QixJ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Q0FBRCxFQUFHLENBQUgsQ0FBL0IsRUFBcUMsQ0FBQyxDQUFELEVBQUcsQ0FBSCxDQUFyQyxFQUEyQyxDQUFDLENBQUQsRUFBRyxDQUFILENBQTNDLEVBQWlELENBQUMsQ0FBRCxFQUFHLENBQUgsQ0FBakQsRUFBdUQsQ0FBQyxDQUFELEVBQUcsQ0FBSCxDQUF2RCxFQUE2RCxDQUFDLENBQUQsRUFBRyxDQUFILENBQTdELEVBQW1FLENBQUMsQ0FBRCxFQUFHLEVBQUgsQ0FBbkUsRUFBMEUsQ0FBQyxDQUFELEVBQUcsRUFBSCxDQUExRSxDQUFmOztBQUNQLE1BQUEsQ0FBTyxDQUFQLEVBQWMsSUFBSSxDQUFDLElBQUwsQ0FBVSxDQUFWLEVBQVksQ0FBWixDQUFkOztBQUNBLE1BQUEsQ0FBTyxDQUFBLEdBQUUsQ0FBVCxFQUFjLElBQUksQ0FBQyxJQUFMLENBQVUsQ0FBVixFQUFZLENBQVosQ0FBZDs7QUFDQSxNQUFBLENBQU8sQ0FBQSxHQUFFLENBQVQsRUFBYyxJQUFJLENBQUMsSUFBTCxDQUFVLENBQVYsRUFBWSxDQUFaLENBQWQ7O0FBQ0EsTUFBQSxDQUFPLENBQUEsR0FBRSxDQUFULEVBQWMsSUFBSSxDQUFDLElBQUwsQ0FBVSxDQUFWLEVBQVksQ0FBWixDQUFkOztBQUNBLE1BQUEsQ0FBTyxFQUFBLEdBQUcsRUFBVixFQUFjLElBQUksQ0FBQyxJQUFMLENBQVUsQ0FBVixFQUFZLEVBQVosQ0FBZDs7QUFDQSxNQUFBLENBQU8sRUFBQSxHQUFHLEVBQVYsRUFBYyxJQUFJLENBQUMsSUFBTCxDQUFVLEVBQVYsRUFBYSxFQUFiLENBQWQiLCJzb3VyY2VzQ29udGVudCI6WyIjIGh0dHA6Ly93d3cuaHVzZHlyLmt2bC5kay9odG0va2MvcG9wZ2VuL2dlbmV0aWNzLzQvNS5odG1cclxuXHJcbmNsYXNzIENhbGN1bGF0b3JcclxuXHRjb25zdHJ1Y3RvciA6IChAcGVyc29ucz1bXSkgLT4gQGNhbGMoKVxyXG5cdGFkZCA6IChzaXJlPTAsZGFtZT0wKSAtPiBAcGVyc29ucy5wdXNoIHtzaXJlLGRhbWV9XHJcblx0Y2FsYyA6ICgpIC0+XHJcblx0XHRuID0gQHBlcnNvbnMubGVuZ3RoXHJcblx0XHRAbWF0cml4ID0gKDAgZm9yIGkgaW4gcmFuZ2UgbiBmb3IgaiBpbiByYW5nZSBuKVxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgMSxuXHJcblx0XHRcdEBtYXRyaXhbaV1baV0gPSAxXHJcblx0XHRcdGZvciBqIGluIHJhbmdlIGkrMSxuXHJcblx0XHRcdFx0W3NpcmUsZGFtZV0gPSBAcGVyc29uc1tqXVxyXG5cdFx0XHRcdEBtYXRyaXhbaV1bal0gPSBAbWF0cml4W2pdW2ldID0gKEBtYXRyaXhbaV1bc2lyZV0gKyBAbWF0cml4W2ldW2RhbWVdKSAvIDJcclxuXHRcdFx0W3NpcmUsZGFtZV0gPSBAcGVyc29uc1tpXVxyXG5cdFx0XHRAbWF0cml4W2ldW2ldICs9IEBtYXRyaXhbc2lyZV1bZGFtZV0gLyAyXHJcblx0Y2VsbCA6IChpLGopIC0+IEBtYXRyaXhbaV1bal1cclxuXHJcbiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcblxyXG5mYWNpdCA9IFtcclxuXHRbMCwgMCwgICAwLCAgICAwLCAgIDAsICAgIDAsICAgICAwLCAgICAgMF1cclxuXHRbMCwgMSwgICAxLzIsICAxLzIsIDEvMiwgIDEvMiwgICAxLzIsICAgMS8yXVxyXG5cdFswLCAxLzIsIDEsICAgIDEvNCwgMS80LCAgNS84LCAgIDEvNCwgICA3LzE2XVxyXG5cdFswLCAxLzIsIDEvNCwgIDEsICAgMS80LCAgNS84LCAgIDUvOCwgICA1LzhdXHJcblx0WzAsIDEvMiwgMS80LCAgMS80LCAxLCAgICAxLzQsICAgNS84LCAgIDcvMTZdXHJcblx0WzAsIDEvMiwgNS84LCAgNS84LCAxLzQsICAxKzEvOCwgNy8xNiwgIDI1LzMyXVxyXG5cdFswLCAxLzIsIDEvNCwgIDUvOCwgNS84LCAgNy8xNiwgIDErMS84LCAyNS8zMl1cclxuXHRbMCwgMS8yLCA3LzE2LCA1LzgsIDcvMTYsIDI1LzMyLCAyNS8zMiwgMSs3LzMyXVxyXG5dXHJcblxyXG50cmVlID0gbmV3IENhbGN1bGF0b3IgW1swLDBdLFswLDBdLFsxLDBdLFsxLDBdLFsxLDBdLFszLDJdLFszLDRdLFs1LDZdXVxyXG5cclxuTiA9IHRyZWUubWF0cml4Lmxlbmd0aFxyXG5mb3IgaSBpbiByYW5nZSAxLE4tMVxyXG5cdGZvciBqIGluIHJhbmdlIDEsTi0xXHJcblx0XHRhc3NlcnQgZmFjaXRbaV1bal0sIHRyZWUuY2VsbCBpLGpcclxuXHJcbmFzc2VydCAxLzQsICB0cmVlLmNlbGwgMywyXHJcbmFzc2VydCAxLzQsICB0cmVlLmNlbGwgMyw0XHJcbmFzc2VydCA3LzE2LCB0cmVlLmNlbGwgNSw2XHJcblxyXG4jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcblxyXG50cmVlID0gbmV3IENhbGN1bGF0b3IgW1swLDBdLFswLDBdLFswLDBdLFsxLDJdLFsxLDJdLFszLDRdLFszLDRdLFs1LDZdLFs1LDZdLFs3LDhdLFs3LDhdLFs5LDEwXSxbOSwxMF1dXHJcbmFzc2VydCAwLCAgICAgdHJlZS5jZWxsIDEsMlxyXG5hc3NlcnQgMS8yLCAgIHRyZWUuY2VsbCAzLDRcclxuYXNzZXJ0IDMvNCwgICB0cmVlLmNlbGwgNSw2XHJcbmFzc2VydCA3LzgsICAgdHJlZS5jZWxsIDcsOFxyXG5hc3NlcnQgMTUvMTYsIHRyZWUuY2VsbCA5LDEwXHJcbmFzc2VydCAzMS8zMiwgdHJlZS5jZWxsIDExLDEyXHJcbiJdfQ==
//# sourceURL=c:\Lab\2020\022-Inbreeding\coffee\sketch.coffee