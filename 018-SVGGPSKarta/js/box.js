// Generated by CoffeeScript 2.4.1
var Box, HEIGHT, RADIUS, SQ2, WIDTH, crossHair, image, messages, scale, stdText;

SQ2 = 2; // Math.sqrt 2

WIDTH = 1639;

HEIGHT = 986;

RADIUS = 35;

messages = [];

stdText = {
  font: '40px Arial',
  fill: '#000'
};

image = null;

crossHair = null;

scale = function(factor) {
  var dx, dy, sx, sy, x, x0, y, y0;
  ({x, y} = image.attrs);
  ({dx, dy, sx, sy} = image._);
  console.log(x, y, dx, dy, sx, sy);
  //[x0,y0] = [0,0]  # NW
  //[x0,y0] = [WIDTH/2,HEIGHT/2]  # center
  //[x0,y0] = [WIDTH,HEIGHT] # SW
  [x0, y0] = [
    WIDTH / 2,
    HEIGHT / 2 // SW
  ];
  image.scale(factor, factor, dx / sx + x + x0, dy / sy + y + y0);
  ({x, y} = image.attrs);
  ({dx, dy, sx, sy} = image._);
  console.log(x, y, dx, dy, sx, sy);
  if (crossHair) {
    return crossHair.scale(factor);
  }
};

Box = class Box {
  constructor(x, y, w, h, name) {
    var a, b, c, d;
    image = raphael.image("data/Skarpnäck.png", (1920 - WIDTH) / 2, (1127 - HEIGHT) / 2, WIDTH, HEIGHT);
    //		image.translate (1920-WIDTH)/2, (1127-HEIGHT)/2
    //image.scale 1,1, 1920/2, 1127/2
    //image.attr {x:(1920-WIDTH)/2, y:(1127-HEIGHT)/2}
    crossHair = raphael.circle(w / 2, h / 2, RADIUS);
    
    //scale SQ2
    //scale 1
    a = raphael.text(0.5 * w, 50, '180º').attr(stdText);
    b = raphael.text(0.95 * w, 50, '345m').attr(stdText);
    c = raphael.text(0.5 * w, 0.95 * h, '59.123456 18.123456').attr(stdText);
    d = raphael.text(0.95 * w, 0.95 * h, '345').attr(stdText);
    messages = [a, b, c, d];
    console.log(messages);
    image.drag(this.move_drag, this.move_start, this.move_up);
    image.mousemove(function(e) { // Ska ge image koordinater
      var dx, dy, sx, sy;
      ({dx, dy, sx, sy} = image._);
      return messages[2].attr({
        text: `${(e.x - dx) / sx - image.attrs.x} = ${e.x} ${dx} ${x} ${sx}   ` + `${(e.y - dy) / sy - image.attrs.y} = ${e.y} ${dy} ${y} ${sy}`
      });
    });
  }

  move_start() {
    return [this.ox, this.oy] = [0, 0];
  }

  move_drag(dx, dy) {
    image.translate((dx - this.ox) / image._.sx, (dy - this.oy) / image._.sy);
    this.ox = dx;
    return this.oy = dy;
  }

  move_up() {
    return console.dir(JSON.stringify(image.attrs));
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm94LmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXGJveC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsR0FBQSxFQUFBLE1BQUEsRUFBQSxNQUFBLEVBQUEsR0FBQSxFQUFBLEtBQUEsRUFBQSxTQUFBLEVBQUEsS0FBQSxFQUFBLFFBQUEsRUFBQSxLQUFBLEVBQUE7O0FBQUEsR0FBQSxHQUFNLEVBQU47O0FBRUEsS0FBQSxHQUFROztBQUNSLE1BQUEsR0FBUzs7QUFDVCxNQUFBLEdBQVM7O0FBRVQsUUFBQSxHQUFXOztBQUVYLE9BQUEsR0FBVTtFQUFDLElBQUEsRUFBTSxZQUFQO0VBQXFCLElBQUEsRUFBTTtBQUEzQjs7QUFFVixLQUFBLEdBQVE7O0FBQ1IsU0FBQSxHQUFZOztBQUVaLEtBQUEsR0FBUSxRQUFBLENBQUMsTUFBRCxDQUFBO0FBRVAsTUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLEVBQUE7RUFBQSxDQUFBLENBQUMsQ0FBRCxFQUFHLENBQUgsQ0FBQSxHQUFRLEtBQUssQ0FBQyxLQUFkO0VBQ0EsQ0FBQSxDQUFDLEVBQUQsRUFBSSxFQUFKLEVBQU8sRUFBUCxFQUFVLEVBQVYsQ0FBQSxHQUFnQixLQUFLLENBQUMsQ0FBdEI7RUFDQSxPQUFPLENBQUMsR0FBUixDQUFZLENBQVosRUFBYyxDQUFkLEVBQWdCLEVBQWhCLEVBQW1CLEVBQW5CLEVBQXNCLEVBQXRCLEVBQXlCLEVBQXpCLEVBRkE7Ozs7RUFPQSxDQUFDLEVBQUQsRUFBSSxFQUFKLENBQUEsR0FBVTtJQUFDLEtBQUEsR0FBTSxDQUFQO0lBQVMsTUFBQSxHQUFPLENBQWhCOztFQUNWLEtBQUssQ0FBQyxLQUFOLENBQVksTUFBWixFQUFtQixNQUFuQixFQUEwQixFQUFBLEdBQUcsRUFBSCxHQUFNLENBQU4sR0FBUSxFQUFsQyxFQUFxQyxFQUFBLEdBQUcs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L0IsQ0FBaUMsR0FBakMsQ0FBQSxDQUFzQyxDQUFDLENBQUMsQ0FBeEMsRUFBQSxDQUFBLENBQTZDLEVBQTdDLEVBQUEsQ0FBQSxDQUFtRCxDQUFuRCxFQUFBLENBQUEsQ0FBd0QsRUFBeEQsQ0FBQTtNQUF6RSxDQUFqQjtJQUZlLENBQWhCO0VBeEJhOztFQTRCZCxVQUFhLENBQUEsQ0FBQTtXQUFHLENBQUMsSUFBQyxDQUFBLEVBQUYsRUFBSyxJQUFDLENBQUEsRUFBTixDQUFBLEdBQVksQ0FBQyxDQUFELEVBQUcsQ0FBSDtFQUFmOztFQUViLFNBQVksQ0FBQyxFQUFELEVBQUssRUFBTCxDQUFBO0lBQ1gsS0FBSyxDQUFDLFNBQU4sQ0FBZ0IsQ0FBQyxFQUFBLEdBQUcsSUFBQyxDQUFBLEVBQUwsQ0FBQSxHQUFXLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBbkMsRUFBdUMsQ0FBQyxFQUFBLEdBQUcsSUFBQyxDQUFBLEVBQUwsQ0FBQSxHQUFXLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBMUQ7SUFDQSxJQUFDLENBQUEsRUFBRCxHQUFNO1dBQ04sSUFBQyxDQUFBLEVBQUQsR0FBTTtFQUhLOztFQUtaLE9BQVUsQ0FBQSxDQUFBO1dBQ1QsT0FBTyxDQUFDLEdBQVIsQ0FBWSxJQUFJLENBQUMsU0FBTCxDQUFlLEtBQUssQ0FBQyxLQUFyQixDQUFaO0VBRFM7O0FBcENYIiwic291cmNlc0NvbnRlbnQiOlsiU1EyID0gMiAjIE1hdGguc3FydCAyXHJcblxyXG5XSURUSCA9IDE2MzlcclxuSEVJR0hUID0gOTg2XHJcblJBRElVUyA9IDM1XHJcblxyXG5tZXNzYWdlcyA9IFtdXHJcblxyXG5zdGRUZXh0ID0ge2ZvbnQ6ICc0MHB4IEFyaWFsJywgZmlsbDogJyMwMDAnfVxyXG5cclxuaW1hZ2UgPSBudWxsXHJcbmNyb3NzSGFpciA9IG51bGxcclxuXHJcbnNjYWxlID0gKGZhY3RvcikgLT5cclxuXHJcblx0e3gseX0gPSBpbWFnZS5hdHRyc1xyXG5cdHtkeCxkeSxzeCxzeX0gPSBpbWFnZS5fXHJcblx0Y29uc29sZS5sb2cgeCx5LGR4LGR5LHN4LHN5XHJcblxyXG5cdCNbeDAseTBdID0gWzAsMF0gICMgTldcclxuXHQjW3gwLHkwXSA9IFtXSURUSC8yLEhFSUdIVC8yXSAgIyBjZW50ZXJcclxuXHQjW3gwLHkwXSA9IFtXSURUSCxIRUlHSFRdICMgU1dcclxuXHRbeDAseTBdID0gW1dJRFRILzIsSEVJR0hULzJdICMgU1dcclxuXHRpbWFnZS5zY2FsZSBmYWN0b3IsZmFjdG9yLGR4L3N4K3greDAsZHkvc3kreSt5MFxyXG5cclxuXHR7eCx5fSA9IGltYWdlLmF0dHJzXHJcblx0e2R4LGR5LHN4LHN5fSA9IGltYWdlLl9cclxuXHRjb25zb2xlLmxvZyB4LHksZHgsZHksc3gsc3lcclxuXHJcblx0aWYgY3Jvc3NIYWlyIHRoZW4gY3Jvc3NIYWlyLnNjYWxlIGZhY3RvclxyXG5cclxuY2xhc3MgQm94IFxyXG5cdGNvbnN0cnVjdG9yIDogKHgseSx3LGgsbmFtZSkgLT5cclxuXHRcdGltYWdlID0gcmFwaGFlbC5pbWFnZSBcImRhdGEvU2thcnBuw6Rjay5wbmdcIiwgKDE5MjAtV0lEVEgpLzIsICgxMTI3LUhFSUdIVCkvMiwgV0lEVEgsIEhFSUdIVFxyXG4jXHRcdGltYWdlLnRyYW5zbGF0ZSAoMTkyMC1XSURUSCkvMiwgKDExMjctSEVJR0hUKS8yXHJcblx0XHQjaW1hZ2Uuc2NhbGUgMSwxLCAxOTIwLzIsIDExMjcvMlxyXG5cdFx0I2ltYWdlLmF0dHIge3g6KDE5MjAtV0lEVEgpLzIsIHk6KDExMjctSEVJR0hUKS8yfVxyXG5cdFx0Y3Jvc3NIYWlyID0gcmFwaGFlbC5jaXJjbGUgdy8yLGgvMixSQURJVVMgXHJcblx0XHQjc2NhbGUgU1EyXHJcblx0XHQjc2NhbGUgMVxyXG5cclxuXHRcdGEgPSByYXBoYWVsLnRleHQgMC41KncsIDUwLCAnMTgwwronXHJcblx0XHRcdC5hdHRyIHN0ZFRleHRcclxuXHRcdGIgPSByYXBoYWVsLnRleHQgMC45NSp3LCA1MCwgJzM0NW0nXHJcblx0XHRcdC5hdHRyIHN0ZFRleHRcclxuXHJcblx0XHRjID0gcmFwaGFlbC50ZXh0IDAuNSp3LCAwLjk1KmgsICc1OS4xMjM0NTYgMTguMTIzNDU2J1xyXG5cdFx0XHQuYXR0ciBzdGRUZXh0XHJcblx0XHRkID0gcmFwaGFlbC50ZXh0IDAuOTUqdywgMC45NSpoLCAnMzQ1J1xyXG5cdFx0XHQuYXR0ciBzdGRUZXh0XHJcblxyXG5cdFx0bWVzc2FnZXMgPSBbYSxiLGMsZF1cclxuXHJcblx0XHRjb25zb2xlLmxvZyBtZXNzYWdlc1xyXG5cclxuXHRcdGltYWdlLmRyYWcgQG1vdmVfZHJhZywgQG1vdmVfc3RhcnQsIEBtb3ZlX3VwXHJcblx0XHRpbWFnZS5tb3VzZW1vdmUgKGUpIC0+ICMgU2thIGdlIGltYWdlIGtvb3JkaW5hdGVyXHJcblx0XHRcdHtkeCxkeSxzeCxzeX0gPSBpbWFnZS5fXHJcblx0XHRcdG1lc3NhZ2VzWzJdLmF0dHIge3RleHQ6IFwiI3soZS54IC0gZHgpL3N4IC0gaW1hZ2UuYXR0cnMueH0gPSAje2UueH0gI3tkeH0gI3t4fSAje3N4fSAgIFwiICsgXCIjeyhlLnkgLSBkeSkvc3kgLSBpbWFnZS5hdHRycy55fSA9ICN7ZS55fSAje2R5fSAje3l9ICN7c3l9XCJ9XHJcblxyXG5cdG1vdmVfc3RhcnQgOiAtPiBbQG94LEBveV0gPSBbMCwwXVxyXG5cclxuXHRtb3ZlX2RyYWcgOiAoZHgsIGR5KSAtPlxyXG5cdFx0aW1hZ2UudHJhbnNsYXRlIChkeC1Ab3gpIC8gaW1hZ2UuXy5zeCwgKGR5LUBveSkgLyBpbWFnZS5fLnN5XHJcblx0XHRAb3ggPSBkeFxyXG5cdFx0QG95ID0gZHkgXHJcblxyXG5cdG1vdmVfdXAgOiAtPlxyXG5cdFx0Y29uc29sZS5kaXIgSlNPTi5zdHJpbmdpZnkgaW1hZ2UuYXR0cnNcclxuIl19
//# sourceURL=c:\Lab\2020\018-SVGGPSKarta\coffee\box.coffee